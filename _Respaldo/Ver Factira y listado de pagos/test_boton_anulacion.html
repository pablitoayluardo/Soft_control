<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Bot√≥n Anulaci√≥n</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #c82333;
        }
        .success {
            color: #28a745;
            background: #d4edda;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info {
            color: #0c5460;
            background: #d1ecf1;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Bot√≥n Anulaci√≥n</h1>
        <p>Este archivo prueba la funcionalidad del bot√≥n de anulaci√≥n de facturas.</p>
    </div>

    <div class="container">
        <h2>1. Test Funci√≥n confirmarAnulacionConDatos</h2>
        <button class="btn" onclick="testConfirmarAnulacion()">Probar Funci√≥n confirmarAnulacionConDatos</button>
        <div id="test-result-1"></div>
    </div>

    <div class="container">
        <h2>2. Test Funci√≥n showAnularForm</h2>
        <button class="btn" onclick="testShowAnularForm()">Probar Funci√≥n showAnularForm</button>
        <div id="test-result-2"></div>
    </div>

    <div class="container">
        <h2>3. Test Variable facturaEncontrada</h2>
        <button class="btn" onclick="testVariableFactura()">Probar Variable facturaEncontrada</button>
        <div id="test-result-3"></div>
    </div>

    <div class="container">
        <h2>4. Test Bot√≥n Din√°mico</h2>
        <button class="btn" onclick="testBotonDinamico()">Probar Bot√≥n Din√°mico</button>
        <div id="test-result-4"></div>
    </div>

    <script>
        // Simular variable facturaEncontrada
        let facturaEncontrada = {
            estab: '001',
            pto_emi: '001',
            secuencial: '000000001',
            cliente: 'Cliente Test',
            total: '100.00',
            estatus: 'REGISTRADO'
        };

        // Test 1: Funci√≥n confirmarAnulacionConDatos
        function testConfirmarAnulacion() {
            const resultDiv = document.getElementById('test-result-1');
            
            try {
                // Verificar si la funci√≥n existe
                if (typeof confirmarAnulacionConDatos === 'function') {
                    resultDiv.innerHTML = '<div class="success">‚úÖ Funci√≥n confirmarAnulacionConDatos existe</div>';
                    
                    // Probar la funci√≥n con datos de prueba
                    confirmarAnulacionConDatos('001', '001', '000000001');
                    resultDiv.innerHTML += '<div class="info">‚úÖ Funci√≥n ejecutada con datos de prueba</div>';
                } else {
                    resultDiv.innerHTML = '<div class="error">‚ùå Funci√≥n confirmarAnulacionConDatos no existe</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">‚ùå Error al ejecutar la funci√≥n: ' + error.message + '</div>';
            }
        }

        // Test 2: Funci√≥n showAnularForm
        function testShowAnularForm() {
            const resultDiv = document.getElementById('test-result-2');
            
            try {
                if (typeof showAnularForm === 'function') {
                    resultDiv.innerHTML = '<div class="success">‚úÖ Funci√≥n showAnularForm existe</div>';
                    showAnularForm();
                    resultDiv.innerHTML += '<div class="info">‚úÖ Modal de anulaci√≥n abierto</div>';
                } else {
                    resultDiv.innerHTML = '<div class="error">‚ùå Funci√≥n showAnularForm no existe</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">‚ùå Error al ejecutar showAnularForm: ' + error.message + '</div>';
            }
        }

        // Test 3: Variable facturaEncontrada
        function testVariableFactura() {
            const resultDiv = document.getElementById('test-result-3');
            
            if (facturaEncontrada) {
                resultDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ Variable facturaEncontrada existe<br>
                        <strong>Datos de prueba:</strong><br>
                        ‚Ä¢ Estab: ${facturaEncontrada.estab}<br>
                        ‚Ä¢ Pto Emi: ${facturaEncontrada.pto_emi}<br>
                        ‚Ä¢ Secuencial: ${facturaEncontrada.secuencial}<br>
                        ‚Ä¢ Cliente: ${facturaEncontrada.cliente}<br>
                        ‚Ä¢ Total: $${facturaEncontrada.total}<br>
                        ‚Ä¢ Estatus: ${facturaEncontrada.estatus}
                    </div>
                `;
            } else {
                resultDiv.innerHTML = '<div class="error">‚ùå Variable facturaEncontrada no existe</div>';
            }
        }

        // Test 4: Bot√≥n Din√°mico
        function testBotonDinamico() {
            const resultDiv = document.getElementById('test-result-4');
            
            try {
                // Crear un bot√≥n din√°mico similar al que se crea en mostrarResultadoAnulacion
                const botonHTML = `
                    <button onclick="testBotonClick('001', '001', '000000001')" style="background: #dc3545; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold;">
                        <i class="fas fa-ban"></i> S√≠, Anular Factura (Test)
                    </button>
                `;
                
                resultDiv.innerHTML = `
                    <div class="info">Bot√≥n din√°mico creado:</div>
                    ${botonHTML}
                `;
                
                // Agregar el bot√≥n al DOM
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = botonHTML;
                resultDiv.appendChild(tempDiv.firstElementChild);
                
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">‚ùå Error al crear bot√≥n din√°mico: ' + error.message + '</div>';
            }
        }

        // Funci√≥n para probar el click del bot√≥n
        function testBotonClick(estab, ptoEmi, secuencial) {
            alert(`Bot√≥n clickeado con datos: Estab=${estab}, PtoEmi=${ptoEmi}, Secuencial=${secuencial}`);
        }

        // Simular las funciones que pueden no existir en este contexto
        if (typeof confirmarAnulacionConDatos === 'undefined') {
            window.confirmarAnulacionConDatos = function(estab, ptoEmi, secuencial) {
                console.log('confirmarAnulacionConDatos llamada con:', { estab, ptoEmi, secuencial });
                alert(`Funci√≥n confirmarAnulacionConDatos ejecutada con: Estab=${estab}, PtoEmi=${ptoEmi}, Secuencial=${secuencial}`);
            };
        }

        if (typeof showAnularForm === 'undefined') {
            window.showAnularForm = function() {
                console.log('showAnularForm llamada');
                alert('Funci√≥n showAnularForm ejecutada');
            };
        }
    </script>
</body>
</html> 